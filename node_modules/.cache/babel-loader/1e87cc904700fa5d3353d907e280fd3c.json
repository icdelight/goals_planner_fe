{"ast":null,"code":"\"use strict\";\n\nvar __extends = this && this.__extends || function () {\n  var extendStatics = function (d, b) {\n    extendStatics = Object.setPrototypeOf || {\n      __proto__: []\n    } instanceof Array && function (d, b) {\n      d.__proto__ = b;\n    } || function (d, b) {\n      for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n    };\n\n    return extendStatics(d, b);\n  };\n\n  return function (d, b) {\n    extendStatics(d, b);\n\n    function __() {\n      this.constructor = d;\n    }\n\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n  };\n}();\n\nvar __assign = this && this.__assign || function () {\n  __assign = Object.assign || function (t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n      s = arguments[i];\n\n      for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n    }\n\n    return t;\n  };\n\n  return __assign.apply(this, arguments);\n};\n\nvar __createBinding = this && this.__createBinding || (Object.create ? function (o, m, k, k2) {\n  if (k2 === undefined) k2 = k;\n  Object.defineProperty(o, k2, {\n    enumerable: true,\n    get: function () {\n      return m[k];\n    }\n  });\n} : function (o, m, k, k2) {\n  if (k2 === undefined) k2 = k;\n  o[k2] = m[k];\n});\n\nvar __setModuleDefault = this && this.__setModuleDefault || (Object.create ? function (o, v) {\n  Object.defineProperty(o, \"default\", {\n    enumerable: true,\n    value: v\n  });\n} : function (o, v) {\n  o[\"default\"] = v;\n});\n\nvar __importStar = this && this.__importStar || function (mod) {\n  if (mod && mod.__esModule) return mod;\n  var result = {};\n  if (mod != null) for (var k in mod) if (k !== \"default\" && Object.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\n\n  __setModuleDefault(result, mod);\n\n  return result;\n};\n\nvar __importDefault = this && this.__importDefault || function (mod) {\n  return mod && mod.__esModule ? mod : {\n    \"default\": mod\n  };\n};\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar fuse_js_1 = __importDefault(require(\"fuse.js\"));\n\nvar React = __importStar(require(\"react\"));\n\nvar formatResults_1 = require(\"./formatResults\");\n\nvar FuzzyHighlighter = function (_super) {\n  __extends(FuzzyHighlighter, _super);\n\n  function FuzzyHighlighter() {\n    var _this = _super !== null && _super.apply(this, arguments) || this;\n\n    _this.state = {\n      results: [],\n      cache: {},\n      info: {\n        timing: 0\n      }\n    };\n    return _this;\n  }\n\n  FuzzyHighlighter.prototype.componentDidMount = function () {\n    var _a = this.props,\n        data = _a.data,\n        options = _a.options;\n    this.fuse = new fuse_js_1.default(data, __assign(__assign({}, options), {\n      shouldSort: true,\n      includeMatches: true\n    }));\n    this.search();\n  };\n\n  FuzzyHighlighter.prototype.componentDidUpdate = function (prevProps) {\n    if (prevProps.query !== this.props.query) {\n      this.search();\n    }\n\n    if (prevProps.data !== this.props.data) {\n      this.fuse.setCollection(this.props.data);\n      this.setState({\n        cache: {}\n      }, this.search);\n    }\n  };\n\n  FuzzyHighlighter.prototype.render = function () {\n    var children = this.props.children;\n    var _a = this.state,\n        results = _a.results,\n        info = _a.info;\n\n    if (children) {\n      return children({\n        results: results,\n        formattedResults: formatResults_1.formatResults(results),\n        timing: info.timing\n      });\n    }\n\n    return null;\n  };\n\n  FuzzyHighlighter.prototype.search = function () {\n    var _a;\n\n    var query = this.props.query;\n    var cache = this.state.cache;\n\n    if (Object(cache).hasOwnProperty(query)) {\n      return this.setState({\n        results: cache[query],\n        info: {\n          timing: 0\n        }\n      });\n    }\n\n    var start = window.performance.now();\n    var search = this.fuse.search(query);\n    var end = window.performance.now();\n    var results = search;\n    var timing = parseFloat((end - start).toFixed(3));\n    this.setState({\n      results: results,\n      cache: __assign(__assign({}, cache), (_a = {}, _a[query] = results, _a)),\n      info: {\n        timing: timing\n      }\n    });\n  };\n\n  return FuzzyHighlighter;\n}(React.Component);\n\nexports.default = FuzzyHighlighter;","map":null,"metadata":{},"sourceType":"script"}